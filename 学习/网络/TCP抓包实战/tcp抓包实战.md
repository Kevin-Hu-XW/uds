## TCP抓包实战
#### 三次握手

wireshark抓包获取访问指定服务端数据包

 Step1：启动wireshark抓包，打开浏览器输入www.baidu.com

Step2：使用ping www.baidu.com 获取IP

<img src="C:\Users\Admin\Desktop\工作\uds\学习\TCP抓包实战\ping.png" style="zoom:100%;" />



![](C:\Users\Admin\Desktop\工作\uds\学习\TCP抓包实战\http.png)

图中可以看到wireshark截获到了三次握手的三个数据包。第四个包才是HTTP的， 这说明HTTP的确是使用TCP建立连接的。

**第一次握手**

客户端发送一个TCP，标志位SYN为0，表示客户端请求建立连接

![](C:\Users\Admin\Desktop\工作\uds\学习\TCP抓包实战\第一次握手.png)

数据包的关键属性如下：

 SYN ：标志位，表示请求建立连接

 Seq = 0 ：初始建立连接值为0，数据包的相对序列号从0开始，表示当前还没有发送数据

​					 (发送数据顺序的编号，发送方告诉接收方该网络包发送的数据相当于所有发送数据的第几个字节) 

Ack =0：初始建立连接值为0，已经收到包的数量，表示当前没有接收到数据

​				(接收数据顺序的编号，接收方告诉发送方已经收到所有数据的第几个字节)

**第二次握手**

服务端发回确认包，标志位SYN、ACK，将确认序号设置为客户端的seq加1，即0+1=1

![](C:\Users\Admin\Desktop\工作\uds\学习\TCP抓包实战\第二次握手.png)

 数据包的关键属性如下：

[SYN + ACK]：标志位，同意建立连接，并回送SYN+ACK

 Seq = 0 ：初始建立值为0，表示当前还没有发送数据

 Ack = 1：表示当前端成功接收的数据位数，虽然客户端没有发送任何有效数据，确认号还是被加1，因为包含SYN或FIN标志位。（并不会对有效数据的计数产生影响，因为含有SYN或FIN标志位的包并不携带有效数据）

**第三次握手**

客户端再次发送确认包(ACK) SYN标志位为0,ACK标志位为1.并且把服务器发来ACK的序号字段+1,放在确定字段中发送给对方.并且在数据段放写ISN的+1

![](C:\Users\Admin\Desktop\工作\uds\学习\TCP抓包实战\第三次握手.png)

ACK ：标志位，表示已经收到记录

 Seq = 1 ：表示当前已经发送1个数据

 Ack = 1 : 表示当前端成功接收的数据位数，虽然服务端没有发送任何有效数据，确认号还是被加1，因为包含SYN或FIN标志位（并不会对有效数据的计数产生影响，因为含有SYN或FIN标志位的包并不携带有效数据)。

 就这样通过了TCP三次握手，建立了连接。开始进行数据交互
